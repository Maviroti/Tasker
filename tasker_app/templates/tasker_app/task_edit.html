{% extends "tasker_app/base.html" %}

{% block content %}
<div class="div-form">
    <form method="post" id="taskForm">
        {% csrf_token %}
        {% for field in form %}
        <div class="mb-3">
            <label for="{{ field.id_for_label }}" class="form-label">
                {{ field.label }}
            </label>
            {{ field }}
        </div>
        {% endfor %}
        <button type=" submit" class="btn btn-primary" id="submitBtn" disabled>Сохранить</button>
    </form>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const form = document.getElementById('taskForm');
        const submitBtn = document.getElementById('submitBtn');
        const inputs = form.querySelectorAll('input:not([type="hidden"]), textarea, select');

        // Функция проверки изменений
        function checkFormChanges() {
            let hasChanges = false;

            inputs.forEach(input => {

                const originalValue = input.getAttribute('data-original') || '';
                const currentValue = input.value;
                if (currentValue !== originalValue) {
                    hasChanges = true;
                }
            });

            // Включаем/выключаем кнопку
            submitBtn.disabled = !hasChanges;
        }

        // Слушаем изменения во всех полях
        inputs.forEach(input => {
            input.addEventListener('input', checkFormChanges);
            input.addEventListener('change', checkFormChanges);
        });

        // Первоначальная проверка
        checkFormChanges();

    });
</script>
{% endblock %}