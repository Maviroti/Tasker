{% extends "tasker_app/base.html" %}

{% block content %}
<div class="div-form">
    <form method="post" id="taskForm">
        {% csrf_token %}
        {% for field in form %}
        <div class="mb-3">
            <label for="{{ field.id_for_label }}" class="form-label">
                {{ field.label }}
            </label>
            {{ field }}

            {% if field.errors %}
            <div class="invalid-feedback d-block">
                {% for error in field.errors %}
                {{ error }}
                {% endfor %}
            </div>
            {% endif %}
        </div>
        {% endfor %}
        <button type=" submit" class="btn btn-primary" id="submitBtn">Сохранить</button>
    </form>
</div>

<!-- <script>
    document.addEventListener('DOMContentLoaded', function () {
        const form = document.getElementById('taskForm');
        const submitBtn = document.getElementById('submitBtn');
        const inputs = form.querySelectorAll('input:not([type="hidden"]), textarea, select');

        // Функция проверки изменений
        function checkFormChanges() {
            let hasChanges = false;

            inputs.forEach(input => {

                const originalValue = input.getAttribute('data-original') || '';
                let currentValue = input.value;

                // console.log(`input.tagName == `, input.tagName);
                // Для select полей сравниваем data-original с выбранным текстом
                if (input.tagName === 'SELECT') {

                    console.log(`input.selectedIndex == `, input.mult);
                    const selectedOption = input.options[input.selectedIndex];
                    console.log(`selectedOption == `, selectedOption);
                    if (selectedOption) {
                        console.log(`selectedOption.text == `, selectedOption.text);

                        // Сравниваем с текстом выбранной опции
                        currentValue = selectedOption.text;
                        console.log(currentValue, ` -- `, originalValue);
                    }
                }

                if (currentValue !== originalValue) {
                    hasChanges = true;
                }
            });

            // Включаем/выключаем кнопку
            submitBtn.disabled = !hasChanges;
        }

        // Слушаем изменения во всех полях
        inputs.forEach(input => {
            input.addEventListener('input', checkFormChanges);
            input.addEventListener('change', checkFormChanges);
        });

        // Первоначальная проверка
        checkFormChanges();

    });
</script> -->
{% endblock %}